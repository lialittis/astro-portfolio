---
title: Security News – 2025-12-19
date: 2025-12-19
tags: [security, news]
---

## Schneier on Security
*Security news and analysis by Bruce Schneier*

### [Someone Boarded a Plane at Heathrow Without a Ticket or Passport](https://www.schneier.com/blog/archives/2025/12/someone-boarded-a-plane-at-heathrow-without-a-ticket-or-passport.html) - December 18, 2025

<p>I&#8217;m sure there&#8217;s a <a href="https://ca.news.yahoo.com/man-boards-heathrow-flight-without-081243825.html">story here</a>:</p>
<blockquote><p>Sources say the man had tailgated his way through to security screening and passed security, meaning he was not detected carrying any banned items.</p>
<p>The man deceived the BA check-in agent by posing as a family member who had their passports and boarding passes inspected in the usual way.</p></blockquote>


## SecurityWeek
*Latest cybersecurity news*

### [UEFI Vulnerability in Major Motherboards Enables Early-Boot Attacks](https://www.securityweek.com/uefi-vulnerability-in-major-motherboards-enables-early-boot-attacks/) - December 18, 2025

<p>ASRock, Asus, Gigabyte, and MSI motherboards are vulnerable to early-boot DMA attacks.</p>
<p>The post <a href="https://www.securityweek.com/uefi-vulnerability-in-major-motherboards-enables-early-boot-attacks/">UEFI Vulnerability in Major Motherboards Enables Early-Boot Attacks</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>

### [HPE Patches Critical Flaw in IT Infrastructure Management Software](https://www.securityweek.com/hpe-patches-critical-flaw-in-it-infrastructure-management-software/) - December 18, 2025

<p>Tracked as CVE-2025-37164, the critical flaw could allow unauthenticated, remote attackers to execute arbitrary code.</p>
<p>The post <a href="https://www.securityweek.com/hpe-patches-critical-flaw-in-it-infrastructure-management-software/">HPE Patches Critical Flaw in IT Infrastructure Management Software</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>


## The Hacker News
*Cybersecurity news and insights*

### [HPE OneView Flaw Rated CVSS 10.0 Allows Unauthenticated Remote Code Execution](https://thehackernews.com/2025/12/hpe-oneview-flaw-rated-cvss-100-allows.html) - December 18, 2025

Hewlett Packard Enterprise (HPE) has resolved a maximum-severity security flaw in OneView Software that, if successfully exploited, could result in remote code execution.
The critical vulnerability, assigned the CVE identifier CVE-2025-37164, carries a CVSS score of 10.0. HPE OneView is an IT infrastructure management software that streamlines IT operations and controls all systems via a


## SecurityWeek
*Latest cybersecurity news*

### [CISA Warns of Exploited Flaw in Asus Update Tool](https://www.securityweek.com/cisa-warns-of-exploited-flaw-in-asus-update-tool/) - December 18, 2025

<p>Tracked as CVE-2025-59374, the issue is a software backdoor implanted in Asus Live Update in a supply chain attack.</p>
<p>The post <a href="https://www.securityweek.com/cisa-warns-of-exploited-flaw-in-asus-update-tool/">CISA Warns of Exploited Flaw in Asus Update Tool</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>


## The Hacker News
*Cybersecurity news and insights*

### [ThreatsDay Bulletin: WhatsApp Hijacks, MCP Leaks, AI Recon, React2Shell Exploit and 15 More Stories](https://thehackernews.com/2025/12/threatsday-bulletin-whatsapp-hijacks.html) - December 18, 2025

This week’s ThreatsDay Bulletin tracks how attackers keep reshaping old tools and finding new angles in familiar systems. Small changes in tactics are stacking up fast, and each one hints at where the next big breach could come from.
From shifting infrastructures to clever social hooks, the week’s activity shows just how fluid the threat landscape has become.
Here’s the full rundown of what

### [The Case for Dynamic AI-SaaS Security as Copilots Scale](https://thehackernews.com/2025/12/the-case-for-dynamic-ai-saas-security.html) - December 18, 2025

Within the past year, artificial intelligence copilots and agents have quietly permeated the SaaS applications businesses use every day. Tools like Zoom, Slack, Microsoft 365, Salesforce, and ServiceNow now come with built-in AI assistants or agent-like features. Virtually every major SaaS vendor has rushed to embed AI into their offerings.
The result is an explosion of AI capabilities across


## SecurityWeek
*Latest cybersecurity news*

### [113,000 Impacted by Data Breach at Virginia Mental Health Authority](https://www.securityweek.com/113000-impacted-by-data-breach-at-virginia-mental-health-authority/) - December 18, 2025

<p>Threat actors stole names, Social Security numbers, and financial and health information, and deployed ransomware on RBHA’s systems.</p>
<p>The post <a href="https://www.securityweek.com/113000-impacted-by-data-breach-at-virginia-mental-health-authority/">113,000 Impacted by Data Breach at Virginia Mental Health Authority</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>

### [IoT Security Firm Exein Raises €100 Million](https://www.securityweek.com/iot-security-firm-exein-raises-e100-million/) - December 18, 2025

<p>The Italian company has raised nearly $200 million in 2025 for its widely used embedded cybersecurity platform.</p>
<p>The post <a href="https://www.securityweek.com/iot-security-firm-exein-raises-e100-million/">IoT Security Firm Exein Raises €100 Million</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>

### [France Probes ‘Foreign Interference’ After Remote Control Malware Found on Passenger Ferry](https://www.securityweek.com/france-probes-foreign-interference-after-remote-control-malware-found-on-passenger-ferry/) - December 18, 2025

<p>France’s counterespionage agency is investigating a suspected cyberattack plot targeting an international passenger ferry</p>
<p>The post <a href="https://www.securityweek.com/france-probes-foreign-interference-after-remote-control-malware-found-on-passenger-ferry/">France Probes &#8216;Foreign Interference&#8217; After Remote Control Malware Found on Passenger Ferry</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>

### [SonicWall Patches Exploited SMA 1000 Zero-Day](https://www.securityweek.com/sonicwall-patches-exploited-sma-1000-zero-day/) - December 18, 2025

<p>The medium-severity flaw has been exploited in combination with a critical bug for remote code execution.</p>
<p>The post <a href="https://www.securityweek.com/sonicwall-patches-exploited-sma-1000-zero-day/">SonicWall Patches Exploited SMA 1000 Zero-Day</a> appeared first on <a href="https://www.securityweek.com">SecurityWeek</a>.</p>


## The Hacker News
*Cybersecurity news and insights*

### [CISA Flags Critical ASUS Live Update Flaw After Evidence of Active Exploitation](https://thehackernews.com/2025/12/cisa-flags-critical-asus-live-update.html) - December 18, 2025

The U.S. Cybersecurity and Infrastructure Security Agency (CISA) on Wednesday added a critical flaw impacting ASUS Live Update to its Known Exploited Vulnerabilities (KEV) catalog, citing evidence of active exploitation.
The vulnerability, tracked as CVE-2025-59374 (CVSS score: 9.3), has been described as an "embedded malicious code vulnerability" introduced by means of a supply chain compromise

### [SonicWall Fixes Actively Exploited CVE-2025-40602 in SMA 100 Appliances](https://thehackernews.com/2025/12/sonicwall-fixes-actively-exploited-cve.html) - December 17, 2025

SonicWall has rolled out fixes to address a security flaw in Secure Mobile Access (SMA) 100 series appliances that it said has been actively exploited in the wild.
The vulnerability, tracked as CVE-2025-40602 (CVSS score: 6.6), concerns a case of local privilege escalation that arises as a result of insufficient authorization in the appliance management console (AMC).
It affects the following

### [Kimwolf Botnet Hijacks 1.8 Million Android TVs, Launches Large-Scale DDoS Attacks](https://thehackernews.com/2025/12/kimwolf-botnet-hijacks-18-million.html) - December 17, 2025

A new distributed denial-of-service (DDoS) botnet known as Kimwolf has enlisted a massive army of no less than 1.8 million infected devices comprising Android-based TVs, set-top boxes, and tablets, and may be associated with another botnet known as AISURU, according to findings from QiAnXin XLab.
"Kimwolf is a botnet compiled using the NDK [Native Development Kit]," the company said in a report


## Schneier on Security
*Security news and analysis by Bruce Schneier*

### [Deliberate Internet Shutdowns](https://www.schneier.com/blog/archives/2025/12/deliberate-internet-shutdowns.html) - December 17, 2025

<p>For <a href="https://www.bbc.com/news/articles/c0jq2q5jnw3o">two days</a> in September, Afghanistan had <a href="https://ioda.inetintel.cc.gatech.edu/country/AF?from=1759067186&#38;until=1759326386&#38;view=view1">no internet</a>. No satellite failed; no cable was cut. This was a deliberate outage, mandated by the Taliban government. It followed a more localized shutdown two weeks prior, reportedly instituted &#8220;to prevent immoral activities.&#8221; No additional explanation was given. The timing couldn&#8217;t have been worse: communities still reeling from a major earthquake <a href="https://www.reuters.com/world/asia-pacific/afghanistans-cellphone-internet-services-down-monitoring-shows-2025-09-30/">lost emergency communications</a>, <a href="https://www.bbc.com/news/articles/cdxqdy5nrlqo">flights were grounded</a>, and <a href="https://www.cnn.com/2025/10/03/asia/afghanistan-internet-shutdown-intl-hnk-dst">banking was interrupted</a>. Afghanistan&#8217;s blackout is part of a wider pattern. Just since the end of September, there were also major nationwide internet shutdowns in ...</p>


## Trail of Bits Blog
*Security research and insights from Trail of Bits*

### [Use GWP-ASan to detect exploits in production environments](https://blog.trailofbits.com/2025/12/16/use-gwp-asan-to-detect-exploits-in-production-environments/) - December 16, 2025

<p>Memory safety bugs like use-after-free and buffer overflows remain among the most exploited vulnerability classes in production software. While AddressSanitizer (ASan) excels at catching these bugs during development, its <a href="https://developers.redhat.com/blog/2021/05/05/memory-error-checking-in-c-and-c-comparing-sanitizers-and-valgrind">performance overhead (2 to 4 times)</a> and <a href="https://seclists.org/oss-sec/2016/q1/363">security concerns</a> make it unsuitable for production. What if you could detect many of the same critical bugs in live systems with virtually no performance impact?</p>
<p>GWP-ASan (GWP-ASan Will Provide Allocation SANity) addresses this gap by using a sampling-based approach. By instrumenting only a fraction of memory allocations, it can detect double-free, use-after-free, and heap-buffer-overflow errors in production at scale while maintaining near-native performance.</p>
<p>In this post, we’ll explain how allocation sanitizers like GWP-ASan work and show how to use one in your projects, using an example based on GWP-ASan from <a href="https://llvm.org/docs/ScudoHardenedAllocator.html">LLVM’s scudo allocator</a> in C++. We recommend using it to harden security-critical software since it may help you find rare bugs and vulnerabilities used in the wild.</p>
<h2 id="how-allocation-sanitizers-work">How allocation sanitizers work</h2>
<p>There is more than one allocation sanitizer implementation (e.g., the <a href="https://developer.android.com/ndk/guides/gwp-asan">Android</a>, <a href="https://google.github.io/tcmalloc/gwp-asan.html">TCMalloc</a>, and <a href="https://chromium.googlesource.com/chromium/src.git/+/HEAD/docs/gwp_asan.md">Chromium</a> GWP-ASan implementations, Probabilistic Heap Checker, and <a href="https://docs.kernel.org/dev-tools/kfence.html">Kernel Electric-Fence [KFENCE]</a>), and they all share core principles derived from <a href="https://en.wikipedia.org/wiki/Electric_Fence">Electric Fence</a>. The key technique is to instrument a randomly chosen fraction of heap allocations and, instead of returning memory from the regular heap, place these allocations in special isolated regions with guard pages to detect memory errors. In other words, GWP-ASan trades detection certainty for performance: instead of catching every bug like ASan does, it catches heap-related bugs (use-after-frees, out-of-bounds-heap accesses, and double-frees) with near-zero overhead.</p>
<p>The allocator surrounds each sampled allocation with two inaccessible guard pages (one directly before and one directly after the allocated memory). If the program attempts to access memory within these guard pages, it triggers detection and reporting of the out-of-bounds access.</p>
<p>However, since operating systems allocate memory in page-sized chunks (typically 4 KB or 16 KB), but applications often request much smaller amounts, there is usually leftover space between the guard pages that won&rsquo;t trigger detection even though the access should be considered invalid.</p>
<p>To maximize detection of small buffer overruns despite this limitation, GWP-ASan randomly aligns allocations to either the left or right edge of the accessible region, increasing the likelihood that out-of-bounds accesses will hit a guard page rather than landing in the undetected leftover space.</p>
<p>Figure 1 illustrates this concept. The allocated memory is shown in green, the leftover space in yellow, and the inaccessible guard pages in red. While the allocations are aligned to the left or right edge, some memory alignment requirements can create a third scenario:</p>
<ul>
<li><strong>Left alignment:</strong> Catches underflow bugs immediately but detects only larger overflow bugs (such that they access the right guard page)</li>
<li><strong>Right alignment:</strong> Detects even single-byte overflows but misses smaller underflow bugs</li>
<li><strong>Right alignment with alignment gap:</strong> When allocations have specific alignment requirements (such as structures that must be aligned to certain byte boundaries), GWP-ASan cannot place them right before the second guard page. This creates an unavoidable alignment gap where small buffer overruns may go undetected.</li>
</ul>
<p>




 

 




 


 <figure>
 <img alt="Figure 1: Alignment of an allocated object within two memory pages protected by two inaccessible guard pages" height="922" src="https://blog.trailofbits.com/2025/12/16/use-gwp-asan-to-detect-exploits-in-production-environments/gwp-asan-image-1_hu_7f6b0553d94dd920.webp" width="1200" />
 <figcaption>Figure 1: Alignment of an allocated object within two memory pages protected by two inaccessible guard pages</figcaption>
 </figure>
</p>
<p>GWP-ASan also detects use-after-free bugs by making the freed memory pages inaccessible for the instrumented allocations (by <a href="https://man7.org/linux/man-pages/man2/mprotect.2.html">changing their permissions</a>). Any subsequent access to this memory causes a segmentation fault, allowing GWP-ASan to detect the use-after-free bug.</p>
<h2 id="where-allocation-sanitizers-are-used">Where allocation sanitizers are used</h2>
<p>GWP-ASan&rsquo;s sampling approach makes it viable for production deployment. Rather than instrumenting every allocation like ASan, GWP-ASan typically guards less than 0.1% of allocations, creating negligible performance overhead. This trade-off works at scale—with millions of users, even rare bugs will eventually trigger detection across the user base.</p>
<p>GWP-ASan has been integrated into several major software projects:</p>
<ul>
<li>Google developed <a href="https://chromium.googlesource.com/chromium/src/+/lkgr/docs/gwp_asan.md">GWP-ASan</a> for Chromium, which is enabled in Chrome on Windows and macOS <a href="https://chromium.googlesource.com/chromium/src/+/lkgr/docs/gwp_asan.md#status">by default</a>.</li>
<li>It is <a href="https://github.com/google/tcmalloc/blob/master/docs/gwp-asan.md">available</a> in <a href="https://github.com/google/tcmalloc/tree/master">TCMalloc</a>, Google&rsquo;s thread-caching memory allocator for C and C++.</li>
<li>Mozilla reimplemented GWP-ASan as its Probabilistic Heap Checker (PHC) tool, which is <a href="https://groups.google.com/g/mozilla.dev.platform/c/AyECjDNsqUE/m/Jd7Jr4cXAgAJ">part of Firefox Nightly</a>. Mozilla is also working on enabling it on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1801255">Firefox&rsquo;s release channel</a>.</li>
<li>GWP-ASan is part of Android as well! It’s enabled for some system services and <a href="https://developer.android.com/ndk/guides/gwp-asan">can be easily enabled for other apps by developers, even without recompilation</a>. If you are developing a high profile application, you should consider setting the <code>android:gwpAsanMode</code> tag in your app’s manifest to <code>&quot;always&quot;</code>. But even without that, since Android 14, all apps use <a href="https://developer.android.com/ndk/guides/gwp-asan#recoverable">Recoverable GWP-ASan</a> by default, which enables GWP-ASan in ~1% of app launches and reports the detected bugs; however, it does not terminate the app when bugs occur, potentially allowing for a successful exploitation.</li>
<li>It’s <a href="https://firebase.blog/posts/2023/03/google-for-games-summit-recap/">available in Firebase</a>’s real-time crash reporting tool Crashlytics.</li>
<li>It’s available on Apple&rsquo;s WebKit under the name of <a href="https://github.com/WebKit/WebKit/blob/666b3c85e561ad91d3e8873a2a367f3c1dc8cd9b/Source/bmalloc/libpas/Documentation.md#probabilistic-guard-malloc">Probabilistic Guard Malloc</a> (please don&rsquo;t confuse this with Apple&rsquo;s <a href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/ManagingMemory/Articles/MallocDebug.html">Guard Malloc</a>, which works more like a black box ASan).</li>
</ul>
<p>And GWP-ASan is used in many other projects. You can also easily compile your programs with GWP-ASan <a href="https://llvm.org/docs/GwpAsan.html">using LLVM</a>! In the next section, we’ll walk you through how to do so.</p>
<h2 id="how-to-use-it-in-your-project">How to use it in your project</h2>
<p>In this section, we’ll show you how to use GWP-ASan in a C++ program built with Clang, but the example should easily translate to every language with GWP-ASan support.</p>
<p>To use GWP-ASan in your program, you need an allocator that supports it. (If no such allocator is available on your platform, it’s easy to implement a simple one.) <a href="https://llvm.org/docs/ScudoHardenedAllocator.html">Scudo</a> is one such allocator and is included in the LLVM project; it is also used in <a href="https://source.android.com/docs/security/test/scudo">Android</a> and <a href="https://fuchsia.dev/">Fuchsia</a>. To use Scudo, add the <code>-fsanitize=scudo</code> flag when building your project with Clang. You can also use the <a href="https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html">UndefinedBehaviorSanitizer</a> at the same time by using the <code>-fsanitize=scudo,undefined</code> flag; both are suitable for deployment in production environments.</p>
<p>After building the program with Scudo, you can configure the GWP-ASan sanitization parameters by setting environment variables when the process starts, as shown in figure 2. These are the most important parameters:</p>
<ul>
<li><strong><code>Enabled</code></strong>: A Boolean value that turns GWP-ASan on or off</li>
<li><strong><code>MaxSimultaneousAllocations</code></strong>: The maximum number of guarded allocations at the same time</li>
<li><strong><code>SampleRate</code></strong>: The probability that an allocation will be selected for sanitization (a ratio of one guarded allocation per <code>SampleRate</code> allocations)</li>
</ul>
<figure class="highlight"><pre class="chroma" tabindex="0"><code class="language-text"><span class="line"><span class="cl">$ SCUDO_OPTIONS="GWP_ASAN_SampleRate=1000000:GWP_ASAN_MaxSimultaneousAllocations=128" ./program</span></span></code></pre><figcaption><span>Figure 2: Example GWP-ASan settings</span></figcaption></figure>
<p>The <code>MaxSimultaneousAllocations</code> and <code>SampleRate</code> parameters have default values (<a href="https://llvm.org/docs/GwpAsan.html"><code>16</code> and <code>5000</code></a>, respectively) for situations when the environment variables are not set. The default values can also be overwritten by defining an external function, as shown in figure 3.</p>
<figure class="highlight">
 <pre class="chroma" tabindex="0"><code class="language-cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Setting up default values of GWP-ASan parameters:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">extern</span> <span class="s">"C"</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">__gwp_asan_default_options</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="k">return</span> <span class="s">"MaxSimultaneousAllocations=128:SampleRate=1000000"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Rest of the program
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// …
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre>
 <figcaption><span>Figure 3: Simple example code that overwrites the default GWP-ASan configuration values</span></figcaption>
</figure>
<p>To demonstrate the concept of allocation sanitization using GWP-ASan, we’ll run the tool over a straightforward example of code with a use-after-free error, shown in figure 4.</p>
<figure class="highlight">
 <pre class="chroma" tabindex="0"><code class="language-cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span> <span class="k">const</span> <span class="n">heap</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="mi">32</span><span class="p">]{</span><span class="s">"1234567890"</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">heap</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">delete</span><span class="p">[]</span> <span class="n">heap</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">heap</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// Use After Free!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre>
 <figcaption><span>Figure 4: Simple example code that reads a memory buffer after it’s freed</span></figcaption>
</figure>
<p>We’ll compile the code in figure 4 with Scudo and run it with a <code>SampleRate</code> of <code>10</code> five times in a loop.</p>
<p>The error isn’t detected every time the tool is run, because a <code>SampleRate</code> of <code>10</code> means that an allocation has only a 10% chance of being sampled. However, if we run the process in a loop, we will eventually see a crash.</p>
<figure class="highlight"><pre class="chroma" tabindex="0"><code class="language-text"><span class="line"><span class="cl"><strong>$ clang++ -fsanitize=scudo -g src.cpp -o program</strong>
</span></span><span class="line"><span class="cl"><strong>$ <span style="color: #d73a49;">for</span> f <span style="color: #d73a49;">in</span> {1..5}; <span style="color: #d73a49;">do</span> SCUDO_OPTIONS="GWP_ASAN_SampleRate=10:GWP_ASAN_MaxSimultaneousAllocations=128" ./program; <span style="color: #d73a49;">done</span></strong>
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">*** GWP-ASan detected a memory error ***
</span></span><span class="line"><span class="cl">Use After Free at 0x7f2277aff000 (0 bytes into a 32-byte allocation at 0x7f2277aff000) by thread 95857 here:
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#0 ./program(+0x39ae) [0x5598274d79ae]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#1 ./program(+0x3d17) [0x5598274d7d17]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#2 ./program(+0x3fe4) [0x5598274d7fe4]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#3 /usr/lib/libc.so.6(+0x3e710) [0x7f4f77c3e710]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#4 /usr/lib/libc.so.6(+0x17045c) [0x7f4f77d7045c]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#5 /usr/lib/libstdc++.so.6(_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc+0x1e) [0x7f4f78148dae]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#6 ./program(main+0xac) [0x5598274e4aac]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#7 /usr/lib/libc.so.6(+0x27cd0) [0x7f4f77c27cd0]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#8 /usr/lib/libc.so.6(__libc_start_main+0x8a) [0x7f4f77c27d8a]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#9 ./program(_start+0x25) [0x5598274d6095]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x7f2277aff000 was deallocated by thread 95857 here:
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#0 ./program(+0x39ce) [0x5598274d79ce]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#1 ./program(+0x2299) [0x5598274d6299]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#2 ./program(+0x32fc) [0x5598274d72fc]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#3 ./program(+0xffa4) [0x5598274e3fa4]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#4 ./program(main+0x9c) [0x5598274e4a9c]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#5 /usr/lib/libc.so.6(+0x27cd0) [0x7f4f77c27cd0]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#6 /usr/lib/libc.so.6(__libc_start_main+0x8a) [0x7f4f77c27d8a]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#7 ./program(_start+0x25) [0x5598274d6095]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0x7f2277aff000 was allocated by thread 95857 here:
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#0 ./program(+0x39ce) [0x5598274d79ce]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#1 ./program(+0x2299) [0x5598274d6299]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#2 ./program(+0x2f94) [0x5598274d6f94]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#3 ./program(+0xf109) [0x5598274e3109]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#4 ./program(main+0x24) [0x5598274e4a24]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#5 /usr/lib/libc.so.6(+0x27cd0) [0x7f4f77c27cd0]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#6 /usr/lib/libc.so.6(__libc_start_main+0x8a) [0x7f4f77c27d8a]</span>
</span></span><span class="line"><span class="cl"> <span style="color: #b6b9bb;">#7 ./program(_start+0x25) [0x5598274d6095]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*** End GWP-ASan report ***
</span></span><span class="line"><span class="cl">Segmentation fault (core dumped)
</span></span><span class="line"><span class="cl">1234567890
</span></span><span class="line"><span class="cl">1234567890</span></span></code></pre><figcaption><span>Figure 5: The error printed by the program when the buggy allocation is sampled.</span></figcaption></figure>
<p>When the problematic allocation is sampled, the tool detects the bug and prints an error. Note, however, that for this example program and with the GWP-ASan parameters set to those shown in figure 5, statistically the tool will detect the error only once every 10 executions.</p>
<p>You can experiment with <a href="https://godbolt.org/#g:!((g:!((g:!((g:!((h:codeEditor,i:(filename:'1',fontScale:14,fontUsePx:'0',j:1,lang:c%2B%2B,selection:(endColumn:33,endLineNumber:11,positionColumn:33,positionLineNumber:11,selectionStartColumn:33,selectionStartLineNumber:11,startColumn:33,startLineNumber:11),source:'%23include+%3Ciostream%3E%0A%0Avoid+foo()+%7B%0A%09char+const+*text+%3D+%221234567890%22%3B%0A%09char+*+const+heap+%3D+new+char%5B32%5D%3B%0A%09for(size_t+i+%3D+0%3B+i+%3C%3D+10%3B+%2B%2Bi)+%7B%0A++++%09heap%5Bi%5D+%3D+text%5Bi%5D+*+0%3B%0A%09%7D%0A%09std::cout+%3C%3C+heap+%3C%3C+std::flush%3B%0A%09delete%5B%5D+heap%3B%0A%09std::cout+%3C%3C+heap+%3C%3C+std::flush%3B+//+Use+After+Free!!%0A%7D%0A%0Aint+main()+%7B%0A++++for(size_t+i+%3D+0%3B+i+%3C+1!'000!'000!'000%3B+%2B%2Bi)+%7B%0A++++++++foo()%3B%0A++++%7D%0A%0A%7D%0A'),l:'5',n:'0',o:'C%2B%2B+source+%231',t:'0')),header:(),k:59.669376437589314,l:'4',m:46.878885653576766,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:clang_trunk,deviceViewOpen:'1',filters:(b:'1',binary:'1',binaryObject:'1',commentOnly:'1',debugCalls:'1',demangle:'0',directives:'1',execute:'0',intel:'1',libraryCode:'1',trim:'1'),flagsViewOpen:'1',fontScale:14,fontUsePx:'0',j:1,lang:c%2B%2B,libs:!(),options:'-stdlib%3Dlibc%2B%2B+-O3+-g+-fsanitize%3Dscudo',overrides:!(),selection:(endColumn:1,endLineNumber:1,positionColumn:1,positionLineNumber:1,selectionStartColumn:1,selectionStartLineNumber:1,startColumn:1,startLineNumber:1),source:1),l:'5',n:'0',o:'+x86-64+clang+(trunk)+(Editor+%231)',t:'0')),header:(),k:40.330623562410686,l:'4',m:100,n:'0',o:'',s:0,t:'0')),l:'2',m:77.50177430801988,n:'0',o:'',t:'0'),(g:!((h:output,i:(compilerName:'x86-64+clang+16.0.0',editorid:1,fontScale:14,fontUsePx:'0',j:1,wrap:'1'),l:'5',n:'0',o:'Output+of+x86-64+clang+(trunk)+(Compiler+%231)',t:'0')),l:'4',m:22.498225691980124,n:'0',o:'',s:0,t:'0')),k:100.00000000000003,l:'3',n:'0',o:'',t:'0')),version:4">a live example of this same program here</a> (note that the loop is inside the program rather than outside for convenience).</p>
<p>You may be able to <a href="https://llvm.org/docs/GwpAsan.html#example">improve the readability of the errors</a> by symbolizing the error message using LLVM’s <a href="https://github.com/llvm/llvm-project/blob/main/compiler-rt/lib/gwp_asan/scripts/symbolize.sh"><code>compiler-rt/lib/gwp_asan/scripts/symbolize.sh</code></a> script. The script takes a full error message from standard input and converts memory addresses into symbols and source code lines.</p>
<h2 id="performance-and-memory-overhead">Performance and memory overhead</h2>
<p>Performance and memory overhead depend on the given implementation of GWP-ASan. For example, it’s possible to improve the memory overhead by creating a buffer at startup where every second page is a guard page so that GWP-ASan can periodically reuse accessible pages. So instead of allocating three pages for one guarded allocation every time, it allocates around two. But it limits sanitization to areas smaller than a single memory page.</p>
<p>However, while memory overhead may vary between implementations, the difference is largely negligible. With the <code>MaxSimultaneousAllocations</code> parameter, the overhead can be capped and measured, and the <code>SampleRate</code> parameter can be set to a value that limits CPU overhead to one accepted by developers.</p>
<p>So how big is the performance overhead? We’ll check the impact of the number of allocations on GWP-ASan’s performance by running a simple example program that allocates and deallocates memory in a loop (figure 6).</p>
<figure class="highlight">
 <pre class="chroma" tabindex="0"><code class="language-cpp"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100'000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="kt">char</span> <span class="o">**</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">new_matrix</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="n">access_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="n">delete_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
 <figcaption><span>Figure 6: The main function of the sample program</span></figcaption>
</figure>
<p>The process uses the functions shown in figure 7 to allocate and deallocate memory. The source code contains no bugs.</p>
<figure class="highlight">
 <pre class="chroma" tabindex="0"><code class="language-cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstddef&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">constexpr</span> <span class="n">size_t</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">**</span><span class="nf">new_matrix</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">**</span> <span class="n">matrix</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">*</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">matrix</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">delete_matrix</span><span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="n">matrix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="k">delete</span><span class="p">[]</span> <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">delete</span><span class="p">[]</span> <span class="n">matrix</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">access_matrix</span><span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="n">matrix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">];</span> <span class="c1">// To avoid optimizing-out
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
 <figcaption><span>Figure 7: The sample program’s functions for creating, deleting, and accessing a matrix</span></figcaption>
</figure>
<p>But before we continue, let’s make sure that we understand what exactly impacts performance. We’ll use a control program (figure 8) where allocation and deallocation are called only once and GWP-ASan is turned off.</p>
<figure class="highlight">
 <pre class="chroma" tabindex="0"><code class="language-cpp"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">**</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">new_matrix</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100'000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> 	 	<span class="n">access_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">delete_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
 <figcaption><span>Figure 8: The control version of the program, which allocates and deallocates memory only once</span></figcaption>
</figure>
<p>If we simply run the control program with either a default allocator or the Scudo allocator and with different levels of optimization (0 to 3) and no GWP-ASan, the execution time is negligible compared to the execution time of the original program in figure 6. Therefore, it’s clear that allocations are responsible for most of the execution time, and we can continue using the original program only.</p>
<p>We can now run the program with the Scudo allocator (without GWP-ASan) and with a standard allocator. The results are surprising. Figure 9 shows that the Scudo allocator has much better (smaller) times than the standard allocator. With that in mind, we can continue our test focusing only on the Scudo allocator. While we don’t present a proper benchmark, the results are consistent between different runs, and we aim to only roughly estimate the overhead complexity and confirm that it’s close to linear.</p>
<figure class="highlight"><pre class="chroma" tabindex="0"><code class="language-text"><span class="line"><span class="cl"><strong>$ clang++ -g -O3 performance.cpp -o performance_test_standard</strong>
</span></span><span class="line"><span class="cl"><strong>$ clang++ -fsanitize=scudo -g -O3 performance.cpp -o performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><strong>$ time ./performance_test_standard</strong>
</span></span><span class="line"><span class="cl">3.41s user 18.88s system 99% cpu 22.355 total
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><strong>$ time SCUDO_OPTIONS="GWP_ASAN_Enabled=false" ./performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">4.87s user 0.00s system 99% cpu 4.881 total</span></span></code></pre><figcaption><span>Figure 9: A comparison of the performance of the program running with the Scudo allocator and the standard allocator</span></figcaption></figure>
<p>Because GWP-ASan has very big CPU overhead, for our tests we’ll change the value of the variable <code>N</code> from figure 7 to 256 (<code>N=256</code>) and reduce the number of loops in the <code>main</code> function (figure 8) to 10,000.</p>
<p>We’ll run the program with GWP-ASan with different <code>SampleRate</code> values (figure 10) and an updated <code>N</code> value and number of loops.</p>
<figure class="highlight"><pre class="chroma" tabindex="0"><code class="language-text"><span class="line"><span class="cl"><strong>$ time SCUDO_OPTIONS="GWP_ASAN_Enabled=false" ./performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">0.07s user 0.00s system 99% cpu 0.068 total
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><strong>$ time SCUDO_OPTIONS="GWP_ASAN_SampleRate=1000:GWP_ASAN_MaxSimultaneousAllocations=257" ./performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">0.08s user 0.01s system 98% cpu 0.093 total
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><strong>$ time SCUDO_OPTIONS="GWP_ASAN_SampleRate=100:GWP_ASAN_MaxSimultaneousAllocations=257" ./performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">0.13s user 0.14s system 95% cpu 0.284 total
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><strong>$ time SCUDO_OPTIONS="GWP_ASAN_SampleRate=10:GWP_ASAN_MaxSimultaneousAllocations=257" ./performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">0.46s user 1.53s system 94% cpu 2.117 total
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><strong>$ time SCUDO_OPTIONS="GWP_ASAN_SampleRate=1:GWP_ASAN_MaxSimultaneousAllocations=257" ./performance_test_scudo</strong>
</span></span><span class="line"><span class="cl">5.09s user 16.95s system 93% cpu 23.470 total</span></span></code></pre><figcaption><span>Figure 10: Execution times for different SampleRate values</span></figcaption></figure>
<p>Figure 10 shows that the run time grows linearly with the number of allocations sampled (meaning the lower the <code>SampleRate</code>, the slower the performance). Therefore, guarding every allocation is not possible due to the performance hit. However, it is easy to limit the <code>SampleRate</code> parameter to an acceptable value—large enough to conserve performance but small enough to sample enough allocations. When GWP-ASan is used as designed (with a large <code>SampleRate</code>), the performance hit is negligible.</p>
<h2 id="add-allocation-sanitization-to-your-projects-today">Add allocation sanitization to your projects today!</h2>
<p>GWP-ASan effectively increases bug detection with minimal performance cost and memory overhead. It can be used as a last resort to detect security vulnerabilities, but it should be noted that bugs detected by GWP-ASan could have occurred before being detected—the number of occurrences depends on the sampling rate. Nevertheless, it&rsquo;s better to have a chance of detecting bugs than no chance at all.</p>
<p>If you plan to incorporate allocation sanitization into your programs, <a href="https://www.trailofbits.com/contact/">contact us</a>! We can provide guidance in establishing a reporting system and with evaluating collected crash data. We can also assist you in incorporating robust memory bug detection into your project, using not only ASan and allocation sanitization, but also techniques such as fuzzing and <a href="https://discourse.llvm.org/t/rfc-c-buffer-hardening/65734">buffer hardening</a>.</p>
<p>After we drafted this post, but long before we published it, the paper <a href="https://arxiv.org/abs/2311.09394">“GWP-ASan: Sampling-Based Detection of Memory-Safety Bugs in Production”</a> was published. We suggest reading it for additional details and analyses regarding the use of GWP-ASan in real-world applications.</p>
<p>If you want to learn more about ASan and detect more bugs before they reach production, read our previous blog posts:</p>
<ul>
<li><a href="https://blog.trailofbits.com/2024/05/16/understanding-addresssanitizer-better-memory-safety-for-your-code/">Understanding AddressSanitizer: Better memory safety for your code</a></li>
<li><a href="https://blog.trailofbits.com/2024/09/10/sanitize-your-c-containers-asan-annotations-step-by-step/">Sanitize your C++ containers: ASan annotations step-by-step</a></li>
</ul>

