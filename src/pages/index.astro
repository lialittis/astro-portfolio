---
import Layout from '../layouts/Layout.astro'
import HackerLayout from '../layouts/HackerLayout.astro'
import Card from '../components/Card/index.astro'
import IntroCard from '../components/IntroCard.astro'
import ContactsCard from '../components/ContactsCard.astro'
import TimeZone from '../components/TimeZoneCard.astro'
import Now from '../components/Now.astro'
import Globe from '../components/Globe/Globe'
import '../style/frontpage.css'
import '../style/hacker-theme.css'
import KeyWords from '../components/KeyWords.astro'
import SecurityNewsCard from '../components/SecurityNewsCard.astro'
import StyleSwitcher from '../components/StyleSwitcher.astro'

const ActiveLayout = Layout;
---

<script>
	// Apply style on load
	const style = localStorage.getItem('style') || 'modern';
	document.body.setAttribute('data-style', style);
</script>

<script>
	import { stagger, spring, timeline, type TimelineDefinition } from 'motion'
	import { loaderAnimation } from '../lib/constants'
	const cards = document.querySelectorAll('.card')

	const sequence = [
		loaderAnimation,
		[
			cards,
			{ y: ['40%', '0%'], opacity: [0, 1] },
			{
				at: '-0.1',
				duration: 0.4,
				delay: stagger(0.3),
				easing: spring({ velocity: 100, stiffness: 50, damping: 10 })
			}
		]
	]

	timeline(sequence as TimelineDefinition)
</script>

<StyleSwitcher />

<ActiveLayout
	title='Tianchi YU(于天池) - Developer & Hacker'
	description='Security Researcher & Life Hacker'
>
	<!-- <div id="intro-modal" class="modal">
    <div class="modal-content">
      <div class="hi-text" style="position: z-index: 1;">
        <p>Hey ! I am Glad You Found Me!</p>
      </div>
      <div class="text-center" style="position: z-index: 1;">
        <p>Welcome to My World! 欢迎访问我的网站！</p><br />
        <p>My Name is Tianchi YU (于天池), you'd like to know about:</p>
        <br />
      </div>
      <div class="modal-buttons" style="position:z-index: 100;">
        <a href="/me" class="modal-button">(My LifeStyle) 生活中的我</a>
        <a href="https://lialittis.github.io" class="modal-button"
          >(My Profession) 专业中的我</a
        >
        <button class="modal-button" id="close-modal"
          >(Random Walk) 随便看看～</button
        >
      </div>
      <button id="change-text-button" class="modal-exit-button">
        (Not Interested, Sorry) 点错了，并不想了解你... Bye
      </button>
    </div>
  </div> -->
	<main
		class='text-white m-auto p-2 grid gap-2 max-w-6xl relative w-full sm:p-4 sm:gap-2 md:grid-cols-2 md:gap-3 md:p-6 lg:grid-cols-4 lg:gap-4 lg:auto-rows-auto'
		id="main-content"
	>
		<!-- Terminal Header (Hacker Mode Only) -->
		<div class="terminal-header">
			<div class="terminal-controls">
				<span class="dot red"></span>
				<span class="dot yellow"></span>
				<span class="dot green"></span>
			</div>
			<div class="terminal-title">root@tianchi:~$</div>
		</div>
		
		<!-- Terminal Content Wrapper (Hacker Mode Only) -->
		<div class="terminal-content">
			<!-- Command Line: whoami -->
			<div class="cmd-line">
				<span class="prompt">$</span> <span class="cmd">whoami</span>
			</div>
		</div>
		
		<IntroCard />

		<div class="terminal-content">
			<!-- Command Line: cat skills.txt -->
			<div class="cmd-line">
				<span class="prompt">$</span> <span class="cmd">cat skills.txt</span>
			</div>
		</div>
		
		<KeyWords />

		<div class="terminal-content">
			<!-- Command Line: cat contact.json -->
			<div class="cmd-line">
				<span class="prompt">$</span> <span class="cmd">cat contact.json</span>
			</div>
		</div>
		
		<ContactsCard />

		<div class="terminal-content">
			<!-- Command Line: ls -la ./content -->
			<div class="cmd-line">
				<span class="prompt">$</span> <span class="cmd">ls -la ./content</span>
			</div>
		</div>
		
		<Card
			colSpan='md:col-span-1'
			rowSpan='md:row-span-2'
			title='Blog'
			href='/blog'
		>
			<p>More Coming...</p>
		</Card>
		<SecurityNewsCard />

		<div class="terminal-content">
			<!-- Command Line: ./show_map.sh -->
			<div class="cmd-line">
				<span class="prompt">$</span> <span class="cmd">./show_map.sh</span>
			</div>
		</div>
		
		<Card
			colSpan='md:col-span-1'
			rowSpan='md:row-span-2'
			title='Countries I visited'
			href='travel'
		>
			<div class='h-[250px] w-full relative flex items-center justify-center'>
				<Globe client:load />
			</div>
		</Card>

		<div class="terminal-content">
			<!-- Command Line: tail -f status.log -->
			<div class="cmd-line">
				<span class="prompt">$</span> <span class="cmd">tail -f status.log</span>
			</div>
		</div>
		
		<Now />
		<TimeZone />
	</main>
</ActiveLayout>

<style>
  @import "../style/glassmorphism-theme.css";

  /* ============================================
     MODERN MODE (Default)
     ============================================ */
  
  /* Modern mode: standard grid layout */
  main {
    display: grid !important;
  }

  /* Hide terminal elements in modern mode */
  .terminal-header,
  .terminal-content {
    display: none;
  }

  /* ============================================
     HACKER MODE
     ============================================ */
  
  /* Hacker mode: single column layout with proper structure */
  :global(body[data-style="hacker"]) main {
    display: flex !important;
    flex-direction: column !important;
    max-width: 1200px !important;
    padding: 0 !important;
    gap: 0 !important;
    background: transparent !important;
    grid-template-columns: unset !important;
  }

  /* Terminal wrapper */
  :global(body[data-style="hacker"]) .terminal-header {
    display: flex;
    background: linear-gradient(180deg, #1a1a1a 0%, #0d0d0d 100%);
    border: 1px solid rgba(0, 255, 65, 0.3);
    border-bottom: none;
    padding: 12px 16px;
    align-items: center;
    gap: 12px;
    border-radius: 8px 8px 0 0;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    position: relative;
    z-index: 1;
  }

  /* Terminal content area wrapper */
  :global(body[data-style="hacker"]) .terminal-header ~ * {
    background: #000000;
    border-left: 1px solid rgba(0, 255, 65, 0.3);
    border-right: 1px solid rgba(0, 255, 65, 0.3);
  }

  /* Last element gets bottom border and radius */
  :global(body[data-style="hacker"]) main > *:last-child {
    border-bottom: 1px solid rgba(0, 255, 65, 0.3);
    border-radius: 0 0 8px 8px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8);
    padding-bottom: 32px !important;
    margin-bottom: 0 !important;
  }

  /* Terminal command lines */
  :global(body[data-style="hacker"]) .terminal-content {
    display: block;
    padding: 0 24px;
    background: #000000;
  }

  :global(body[data-style="hacker"]) .cmd-line {
    display: flex;
    font-family: 'SF Mono', 'Monaco', monospace;
    font-size: 14px;
    color: rgba(0, 255, 65, 0.9);
    margin-top: 20px;
    margin-bottom: 12px;
    align-items: center;
    gap: 8px;
  }

  /* First command line after header */
  :global(body[data-style="hacker"]) .terminal-header + .terminal-content .cmd-line {
    margin-top: 24px;
  }

  /* Cards in hacker mode - indented with border */
  :global(body[data-style="hacker"]) main > :not(.terminal-header):not(.terminal-content) {
    margin: 0 0 20px 0;
    padding: 0 32px 0 48px;
    border-left: 2px solid rgba(0, 255, 65, 0.2);
    margin-left: 46px;
    background: #000000 !important;
  }
  
  /* Add top margin for first card */
  :global(body[data-style="hacker"]) .terminal-header + .terminal-content + * {
    margin-top: 8px;
  }

  /* Terminal Window - base styles for hacker mode */
  .terminal-header {
    /* Display and styling handled by hacker mode rules */
  }

  .terminal-controls {
    display: flex;
    gap: 8px;
  }

  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .dot.red { background: #ff5f56; }
  .dot.yellow { background: #ffbd2e; }
  .dot.green { background: #27c93f; }

  .terminal-title {
    font-family: 'SF Mono', 'Monaco', monospace;
    font-size: 13px;
    color: rgba(0, 255, 65, 0.8);
    letter-spacing: 0.5px;
  }

  .terminal-content {
    /* Styling handled by hacker mode rules */
  }

  .cmd-line {
    /* Styling handled by hacker mode rules */
  }

  .cmd-line .prompt {
    color: #00ff41;
    font-weight: bold;
  }

  .cmd-line .cmd {
    color: rgba(0, 255, 65, 0.85);
    animation: typing 0.5s steps(20);
  }

  @keyframes typing {
    from { opacity: 0; }
    to { opacity: 1; }
  }



  /* Hacker theme - Additional subtle effects */
  :global(body[data-style="hacker"]) main::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 10% 20%, rgba(0, 255, 65, 0.02) 0%, transparent 50%),
      radial-gradient(circle at 90% 80%, rgba(0, 200, 83, 0.01) 0%, transparent 50%);
    pointer-events: none;
    z-index: -2;
  }

  :global(body[data-style="hacker"]) .card {
    background: transparent !important;
    border: none !important;
    box-shadow: none !important;
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace !important;
    position: relative;
    backdrop-filter: none !important;
    padding: 16px 0 !important;
    margin: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }

  :global(body[data-style="hacker"]) .card:hover {
    background: rgba(0, 255, 65, 0.03) !important;
    border: none !important;
    box-shadow: none !important;
    transform: none !important;
    border-radius: 4px !important;
  }

  :global(body[data-style="hacker"]) .card h1,
  :global(body[data-style="hacker"]) .card h2,
  :global(body[data-style="hacker"]) .card h3 {
    color: #00ff41 !important;
    font-family: 'SF Mono', 'Monaco', monospace !important;
    text-shadow: 0 0 8px rgba(0, 255, 65, 0.25) !important;
    font-weight: 600 !important;
    letter-spacing: 0.5px !important;
    margin-bottom: 12px !important;
  }

  :global(body[data-style="hacker"]) .card h4,
  :global(body[data-style="hacker"]) .card h5,
  :global(body[data-style="hacker"]) .card h6 {
    color: #00d639 !important;
    font-family: 'SF Mono', 'Monaco', monospace !important;
    text-shadow: 0 0 6px rgba(0, 255, 65, 0.2) !important;
    font-weight: 500 !important;
    margin-bottom: 10px !important;
  }

  :global(body[data-style="hacker"]) .card p,
  :global(body[data-style="hacker"]) .card span,
  :global(body[data-style="hacker"]) .card div {
    color: rgba(0, 255, 65, 0.88) !important;
    font-family: 'SF Mono', 'Monaco', monospace !important;
    font-size: 0.95em !important;
    line-height: 1.8 !important;
    letter-spacing: 0.3px !important;
  }
  
  :global(body[data-style="hacker"]) .card ul,
  :global(body[data-style="hacker"]) .card ol {
    margin: 8px 0 !important;
  }
  
  :global(body[data-style="hacker"]) .card li {
    margin-bottom: 4px !important;
    color: rgba(0, 255, 65, 0.88) !important;
  }

  :global(body[data-style="hacker"]) .card a {
    color: #00ff41 !important;
    text-decoration: none !important;
    border-bottom: 1px solid rgba(0, 255, 65, 0.3) !important;
    transition: all 0.3s ease !important;
  }

  :global(body[data-style="hacker"]) .card a:hover {
    color: #00ff41 !important;
    border-bottom-color: #00ff41 !important;
    text-shadow: 0 0 12px rgba(0, 255, 65, 0.6) !important;
    letter-spacing: 0.5px !important;
  }

  :global(body[data-style="hacker"]) .card .text-xs,
  :global(body[data-style="hacker"]) .card .text-sm {
    color: rgba(0, 255, 65, 0.6) !important;
    font-size: 0.85em !important;
  }

  :global(body[data-style="hacker"]) .card button {
    background: rgba(0, 255, 65, 0.1) !important;
    border: 1px solid rgba(0, 255, 65, 0.4) !important;
    color: #00ff41 !important;
    font-family: 'SF Mono', monospace !important;
    padding: 8px 16px !important;
    transition: all 0.3s ease !important;
  }

  :global(body[data-style="hacker"]) .card button:hover {
    background: rgba(0, 255, 65, 0.2) !important;
    border-color: #00ff41 !important;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.3) !important;
    transform: translateY(-2px) !important;
  }

  :global(body[data-style="hacker"]) .card svg {
    color: rgba(0, 255, 65, 0.7) !important;
    filter: drop-shadow(0 0 4px rgba(0, 255, 65, 0.3)) !important;
  }

  :global(body[data-style="hacker"]) .card:hover svg {
    color: #00ff41 !important;
    filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.5)) !important;
  }

  @keyframes scanline {
    0% { transform: translateY(0); }
    100% { transform: translateY(100%); }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.6; transform: scale(0.8); }
  }

  /* Responsive for hacker layout */
  @media (max-width: 768px) {
    :global(body[data-style="hacker"]) main {
      max-width: 100% !important;
    }

    :global(body[data-style="hacker"]) .terminal-header {
      padding: 10px 12px;
      border-radius: 6px 6px 0 0;
    }

    :global(body[data-style="hacker"]) .terminal-content {
      padding: 0 16px;
    }

    :global(body[data-style="hacker"]) main > :not(.terminal-header):not(.terminal-content) {
      margin: 0 0 16px 0;
      padding: 0 20px 0 32px;
      margin-left: 30px;
    }

    :global(body[data-style="hacker"]) .card {
      padding: 12px 0 !important;
    }

    :global(body[data-style="hacker"]) .cmd-line {
      font-size: 12px;
      margin-top: 16px;
      margin-bottom: 10px;
    }

    :global(body[data-style="hacker"]) .terminal-header + .terminal-content .cmd-line {
      margin-top: 16px;
    }

    :global(body[data-style="hacker"]) .terminal-title {
      font-size: 11px;
    }

    :global(body[data-style="hacker"]) main > *:last-child {
      padding-bottom: 24px !important;
      border-radius: 0 0 6px 6px;
    }
  }

  /* Modern glassmorphism theme */
  main {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%) !important;
    position: relative;
    z-index: 10;
    min-height: 100vh;
  }

  main::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.15) 0%, transparent 50%);
    pointer-events: none;
    z-index: -1;
  }

  /* Use glassmorphism card base */
  :global(.card) {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.08) 100%) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(255, 255, 255, 0.25) !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4) !important;
    transition: all 0.3s ease !important;
    animation: fadeInUp 0.6s ease-out;
  }

  :global(.card:hover) {
    transform: translateY(-8px) !important;
    border-color: rgba(102, 126, 234, 0.5) !important;
    box-shadow: 0 25px 50px rgba(102, 126, 234, 0.25) !important;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.18) 0%, rgba(255, 255, 255, 0.12) 100%) !important;
  }

  /* Typography */
  :global(.card h1), :global(.card h2), :global(.card h3), :global(.card h4), :global(.card h5), :global(.card h6) {
    color: rgba(255, 255, 255, 0.98) !important;
    font-weight: 700 !important;
  }

  :global(.card p) {
    color: rgba(255, 255, 255, 0.9) !important;
    line-height: 1.6 !important;
  }

  :global(.card .text-xs) {
    color: rgba(255, 255, 255, 0.8) !important;
  }

  :global(.card .text-sm) {
    color: rgba(255, 255, 255, 0.75) !important;
  }

  /* Links */
  :global(.card a) {
    color: rgba(255, 255, 255, 0.95) !important;
    transition: all 0.3s ease !important;
    text-decoration: underline !important;
    text-decoration-color: rgba(102, 126, 234, 0.5) !important;
  }

  :global(.card a:hover) {
    color: #78dbff !important;
    text-decoration-color: #78dbff !important;
  }

  :global(.card .text-red-500) {
    background: linear-gradient(135deg, #78dbff 0%, #667eea 100%) !important;
    background-clip: text !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    font-weight: 600 !important;
    text-decoration: none !important;
  }

  :global(.card .text-red-500:hover) {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    background-clip: text !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
  }

  /* Buttons */
  :global(.card button), :global(.card .button-like) {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.3) !important;
    backdrop-filter: blur(15px) !important;
    color: rgba(255, 255, 255, 0.95) !important;
    transition: all 0.3s ease !important;
  }

  :global(.card button:hover), :global(.card .button-like:hover) {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    transform: translateY(-3px) !important;
    border-color: rgba(102, 126, 234, 0.6) !important;
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3) !important;
    color: white !important;
  }

  /* Icons */
  :global(.card svg) {
    color: rgba(255, 255, 255, 0.8) !important;
    transition: all 0.3s ease !important;
  }

  :global(.card:hover svg) {
    color: #78dbff !important;
  }

  /* Special components */
  :global(.intro-card), :global(.contact-card) {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.1) 100%) !important;
  }

  :global(.card .h-\[250px\]) {
    background: rgba(0, 0, 0, 0.2) !important;
    border-radius: 12px !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
  }

  :global(.security-news-card), :global(.keywords-card) {
    background: linear-gradient(135deg, rgba(120, 219, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%) !important;
  }

  :global(.now-card), :global(.timezone-card) {
    background: linear-gradient(135deg, rgba(255, 119, 198, 0.1) 0%, rgba(189, 147, 249, 0.1) 100%) !important;
  }

  :global(.card span), :global(.card div), :global(.card time) {
    color: rgba(255, 255, 255, 0.9) !important;
  }

  /* Animation */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive */
  @media (max-width: 768px) {
    :global(.card p) {
      font-size: 0.95rem !important;
      line-height: 1.5 !important;
    }
    
    :global(.card h1), :global(.card h2), :global(.card h3) {
      font-size: 1.1rem !important;
    }
  }
</style>
