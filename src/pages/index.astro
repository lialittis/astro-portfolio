---
import Layout from '../layouts/Layout.astro'
import HackerLayout from '../layouts/HackerLayout.astro'
import Card from '../components/Card/index.astro'
import IntroCard from '../components/IntroCard.astro'
import ContactsCard from '../components/ContactsCard.astro'
import TimeZone from '../components/TimeZoneCard.astro'
import Now from '../components/Now.astro'
import Globe from '../components/Globe/Globe'
import '../style/frontpage.css'
import '../style/hacker-theme.css'
import KeyWords from '../components/KeyWords.astro'
import SecurityNewsCard from '../components/SecurityNewsCard.astro'
import StyleSwitcher from '../components/StyleSwitcher.astro'

const ActiveLayout = Layout;
---

<script>
	// Apply style on load
	const style = localStorage.getItem('style') || 'modern';
	document.body.setAttribute('data-style', style);
	
	// Toggle layout visibility
	window.addEventListener('DOMContentLoaded', () => {
		const hackerLayout = document.querySelector('.hacker-layout');
		const modernLayout = document.querySelector('.modern-layout');
		
		if (style === 'hacker') {
			hackerLayout?.classList.remove('hidden');
			modernLayout?.classList.add('hidden');
		} else {
			hackerLayout?.classList.add('hidden');
			modernLayout?.classList.remove('hidden');
		}
	});
</script>

<script>
	import { stagger, spring, timeline, type TimelineDefinition } from 'motion'
	import { loaderAnimation } from '../lib/constants'
	const cards = document.querySelectorAll('.card')

	const sequence = [
		loaderAnimation,
		[
			cards,
			{ y: ['40%', '0%'], opacity: [0, 1] },
			{
				at: '-0.1',
				duration: 0.4,
				delay: stagger(0.3),
				easing: spring({ velocity: 100, stiffness: 50, damping: 10 })
			}
		]
	]

	timeline(sequence as TimelineDefinition)
</script>

<StyleSwitcher />

<ActiveLayout
	title='Tianchi YU(于天池) - Developer & Hacker'
	description='Security Researcher & Life Hacker'
>
	<!-- <div id="intro-modal" class="modal">
    <div class="modal-content">
      <div class="hi-text" style="position: z-index: 1;">
        <p>Hey ! I am Glad You Found Me!</p>
      </div>
      <div class="text-center" style="position: z-index: 1;">
        <p>Welcome to My World! 欢迎访问我的网站！</p><br />
        <p>My Name is Tianchi YU (于天池), you'd like to know about:</p>
        <br />
      </div>
      <div class="modal-buttons" style="position:z-index: 100;">
        <a href="/me" class="modal-button">(My LifeStyle) 生活中的我</a>
        <a href="https://lialittis.github.io" class="modal-button"
          >(My Profession) 专业中的我</a
        >
        <button class="modal-button" id="close-modal"
          >(Random Walk) 随便看看～</button
        >
      </div>
      <button id="change-text-button" class="modal-exit-button">
        (Not Interested, Sorry) 点错了，并不想了解你... Bye
      </button>
    </div>
  </div> -->
	<main
		class='text-white m-auto p-2 grid gap-2 max-w-6xl relative w-full sm:p-4 sm:gap-2 md:grid-cols-2 md:gap-3 md:p-6 lg:grid-cols-4 lg:gap-4 lg:auto-rows-auto'
	>
		<!-- Hacker Mode Layout -->
		<div class="hacker-layout">
			<div class="terminal-header">
				<div class="terminal-controls">
					<span class="dot red"></span>
					<span class="dot yellow"></span>
					<span class="dot green"></span>
				</div>
				<div class="terminal-title">root@tianchi:~$</div>
			</div>
			
			<div class="terminal-content">
				<div class="cmd-line">
					<span class="prompt">$</span> <span class="cmd">whoami</span>
				</div>
				<div class="hacker-intro">
					<IntroCard />
				</div>

				<div class="cmd-line">
					<span class="prompt">$</span> <span class="cmd">cat skills.txt</span>
				</div>
				<div class="hacker-section">
					<KeyWords />
				</div>

				<div class="cmd-line">
					<span class="prompt">$</span> <span class="cmd">ls -la ./content</span>
				</div>
				<div class="hacker-grid">
					<Card
						colSpan='md:col-span-1'
						rowSpan='md:row-span-1'
						title='Blog'
						href='/blog'
					>
						<p>More Coming...</p>
					</Card>
					<SecurityNewsCard />
				</div>

				<div class="cmd-line">
					<span class="prompt">$</span> <span class="cmd">./show_map.sh</span>
				</div>
				<div class="hacker-section">
					<Card
						colSpan='md:col-span-1'
						rowSpan='md:row-span-1'
						title='Countries I visited'
						href='travel'
					>
						<div class='h-[250px] w-full relative flex items-center justify-center'>
							<Globe client:load />
						</div>
					</Card>
				</div>

				<div class="cmd-line">
					<span class="prompt">$</span> <span class="cmd">cat contact.json</span>
				</div>
				<div class="hacker-grid">
					<ContactsCard />
					<Now />
					<TimeZone />
				</div>
			</div>
		</div>

		<!-- Modern Mode Layout -->
		<div class="modern-layout hidden">
			<IntroCard />
			<KeyWords />
			<ContactsCard />

			<Card
				colSpan='md:col-span-1'
				rowSpan='md:row-span-2'
				title='Blog'
				href='/blog'
			>
				<p>More Coming...</p>
			</Card>
			<SecurityNewsCard />
			<Card
				colSpan='md:col-span-1'
				rowSpan='md:row-span-2'
				title='Countries I visited'
				href='travel'
			>
				<div class='h-[250px] w-full relative flex items-center justify-center'>
					<Globe client:load />
				</div>
			</Card>
			<Now />
			<TimeZone />
		</div>
	</main>
</ActiveLayout>

<style>
  @import "../style/glassmorphism-theme.css";

  /* Hacker Layout Styles */
  .hacker-layout {
    grid-column: 1 / -1;
    display: flex;
    flex-direction: column;
    gap: 0;
    max-width: 1200px;
    margin: 0 auto;
  }

  .modern-layout {
    display: contents;
  }

  .modern-layout.hidden {
    display: none;
  }

  .hacker-layout.hidden {
    display: none;
  }

  /* Terminal Window */
  .terminal-header {
    background: linear-gradient(180deg, #1a1a1a 0%, #0d0d0d 100%);
    border: 1px solid rgba(0, 255, 65, 0.3);
    border-bottom: none;
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-radius: 8px 8px 0 0;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
  }

  .terminal-controls {
    display: flex;
    gap: 8px;
  }

  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.3);
  }

  .dot.red { background: #ff5f56; }
  .dot.yellow { background: #ffbd2e; }
  .dot.green { background: #27c93f; }

  .terminal-title {
    font-family: 'SF Mono', 'Monaco', monospace;
    font-size: 13px;
    color: rgba(0, 255, 65, 0.8);
    letter-spacing: 0.5px;
  }

  .terminal-content {
    background: #000000;
    border: 1px solid rgba(0, 255, 65, 0.3);
    border-top: 1px solid rgba(0, 255, 65, 0.1);
    padding: 24px;
    border-radius: 0 0 8px 8px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8);
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .cmd-line {
    font-family: 'SF Mono', 'Monaco', monospace;
    font-size: 14px;
    color: rgba(0, 255, 65, 0.9);
    margin-top: 16px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .cmd-line .prompt {
    color: #00ff41;
    font-weight: bold;
  }

  .cmd-line .cmd {
    color: rgba(0, 255, 65, 0.85);
    animation: typing 0.5s steps(20);
  }

  @keyframes typing {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .hacker-intro,
  .hacker-section {
    margin-left: 20px;
    border-left: 2px solid rgba(0, 255, 65, 0.2);
    padding-left: 16px;
  }

  .hacker-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 16px;
    margin-left: 20px;
    border-left: 2px solid rgba(0, 255, 65, 0.2);
    padding-left: 16px;
  }

  /* Hacker theme - Professional & Elegant */
  :global(body[data-style="hacker"]) main {
    background: #000000 !important;
    padding: 32px 16px !important;
  }

  :global(body[data-style="hacker"]) main::before {
    background: 
      radial-gradient(circle at 10% 20%, rgba(0, 255, 65, 0.03) 0%, transparent 50%),
      radial-gradient(circle at 90% 80%, rgba(0, 200, 83, 0.02) 0%, transparent 50%),
      repeating-linear-gradient(0deg, transparent 0px, rgba(0, 255, 65, 0.01) 1px, transparent 2px, transparent 3px);
    animation: scanline 15s linear infinite;
  }

  :global(body[data-style="hacker"]) .card {
    background: rgba(0, 20, 8, 0.6) !important;
    border: 1px solid rgba(0, 255, 65, 0.25) !important;
    border-left: 2px solid rgba(0, 255, 65, 0.5) !important;
    box-shadow: 
      0 2px 12px rgba(0, 0, 0, 0.4),
      inset 0 1px 0 rgba(0, 255, 65, 0.08),
      0 0 20px rgba(0, 255, 65, 0.03) !important;
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace !important;
    position: relative;
    overflow: hidden;
    backdrop-filter: blur(10px);
  }

  :global(body[data-style="hacker"]) .card::before {
    content: '> ';
    position: absolute;
    top: 12px;
    left: 12px;
    color: rgba(0, 255, 65, 0.4);
    font-family: 'SF Mono', monospace;
    font-size: 14px;
    font-weight: bold;
  }

  :global(body[data-style="hacker"]) .card:hover {
    border-color: rgba(0, 255, 65, 0.4) !important;
    border-left-color: #00ff41 !important;
    box-shadow: 
      0 4px 20px rgba(0, 0, 0, 0.6),
      inset 0 1px 0 rgba(0, 255, 65, 0.15),
      0 0 30px rgba(0, 255, 65, 0.08) !important;
    transform: translateX(4px) !important;
  }

  :global(body[data-style="hacker"]) .card h1,
  :global(body[data-style="hacker"]) .card h2,
  :global(body[data-style="hacker"]) .card h3 {
    color: #00ff41 !important;
    font-family: 'SF Mono', 'Monaco', monospace !important;
    text-shadow: 0 0 10px rgba(0, 255, 65, 0.3) !important;
    font-weight: 600 !important;
    letter-spacing: 0.5px !important;
  }

  :global(body[data-style="hacker"]) .card h4,
  :global(body[data-style="hacker"]) .card h5,
  :global(body[data-style="hacker"]) .card h6 {
    color: #00d639 !important;
    font-family: 'SF Mono', 'Monaco', monospace !important;
    text-shadow: 0 0 8px rgba(0, 255, 65, 0.2) !important;
    font-weight: 500 !important;
  }

  :global(body[data-style="hacker"]) .card p,
  :global(body[data-style="hacker"]) .card span,
  :global(body[data-style="hacker"]) .card div {
    color: rgba(0, 255, 65, 0.85) !important;
    font-family: 'SF Mono', 'Monaco', monospace !important;
    font-size: 0.95em !important;
    line-height: 1.7 !important;
    letter-spacing: 0.3px !important;
  }

  :global(body[data-style="hacker"]) .card a {
    color: #00ff41 !important;
    text-decoration: none !important;
    border-bottom: 1px solid rgba(0, 255, 65, 0.3) !important;
    transition: all 0.3s ease !important;
  }

  :global(body[data-style="hacker"]) .card a:hover {
    color: #00ff41 !important;
    border-bottom-color: #00ff41 !important;
    text-shadow: 0 0 12px rgba(0, 255, 65, 0.6) !important;
    letter-spacing: 0.5px !important;
  }

  :global(body[data-style="hacker"]) .card .text-xs,
  :global(body[data-style="hacker"]) .card .text-sm {
    color: rgba(0, 255, 65, 0.6) !important;
    font-size: 0.85em !important;
  }

  :global(body[data-style="hacker"]) .card button {
    background: rgba(0, 255, 65, 0.1) !important;
    border: 1px solid rgba(0, 255, 65, 0.4) !important;
    color: #00ff41 !important;
    font-family: 'SF Mono', monospace !important;
    padding: 8px 16px !important;
    transition: all 0.3s ease !important;
  }

  :global(body[data-style="hacker"]) .card button:hover {
    background: rgba(0, 255, 65, 0.2) !important;
    border-color: #00ff41 !important;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.3) !important;
    transform: translateY(-2px) !important;
  }

  :global(body[data-style="hacker"]) .card svg {
    color: rgba(0, 255, 65, 0.7) !important;
    filter: drop-shadow(0 0 4px rgba(0, 255, 65, 0.3)) !important;
  }

  :global(body[data-style="hacker"]) .card:hover svg {
    color: #00ff41 !important;
    filter: drop-shadow(0 0 8px rgba(0, 255, 65, 0.5)) !important;
  }

  @keyframes scanline {
    0% { transform: translateY(0); }
    100% { transform: translateY(100%); }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.6; transform: scale(0.8); }
  }

  /* Responsive for hacker layout */
  @media (max-width: 768px) {
    .terminal-content {
      padding: 16px;
    }

    .hacker-grid {
      grid-template-columns: 1fr;
      margin-left: 12px;
      padding-left: 12px;
    }

    .cmd-line {
      font-size: 12px;
    }

    .terminal-title {
      font-size: 11px;
    }
  }

  /* Modern glassmorphism theme */
  main {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%) !important;
    position: relative;
    z-index: 10;
    min-height: 100vh;
  }

  main::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.15) 0%, transparent 50%);
    pointer-events: none;
    z-index: -1;
  }

  /* Use glassmorphism card base */
  :global(.card) {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.08) 100%) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(255, 255, 255, 0.25) !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4) !important;
    transition: all 0.3s ease !important;
    animation: fadeInUp 0.6s ease-out;
  }

  :global(.card:hover) {
    transform: translateY(-8px) !important;
    border-color: rgba(102, 126, 234, 0.5) !important;
    box-shadow: 0 25px 50px rgba(102, 126, 234, 0.25) !important;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.18) 0%, rgba(255, 255, 255, 0.12) 100%) !important;
  }

  /* Typography */
  :global(.card h1), :global(.card h2), :global(.card h3), :global(.card h4), :global(.card h5), :global(.card h6) {
    color: rgba(255, 255, 255, 0.98) !important;
    font-weight: 700 !important;
  }

  :global(.card p) {
    color: rgba(255, 255, 255, 0.9) !important;
    line-height: 1.6 !important;
  }

  :global(.card .text-xs) {
    color: rgba(255, 255, 255, 0.8) !important;
  }

  :global(.card .text-sm) {
    color: rgba(255, 255, 255, 0.75) !important;
  }

  /* Links */
  :global(.card a) {
    color: rgba(255, 255, 255, 0.95) !important;
    transition: all 0.3s ease !important;
    text-decoration: underline !important;
    text-decoration-color: rgba(102, 126, 234, 0.5) !important;
  }

  :global(.card a:hover) {
    color: #78dbff !important;
    text-decoration-color: #78dbff !important;
  }

  :global(.card .text-red-500) {
    background: linear-gradient(135deg, #78dbff 0%, #667eea 100%) !important;
    background-clip: text !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    font-weight: 600 !important;
    text-decoration: none !important;
  }

  :global(.card .text-red-500:hover) {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    background-clip: text !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
  }

  /* Buttons */
  :global(.card button), :global(.card .button-like) {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.3) !important;
    backdrop-filter: blur(15px) !important;
    color: rgba(255, 255, 255, 0.95) !important;
    transition: all 0.3s ease !important;
  }

  :global(.card button:hover), :global(.card .button-like:hover) {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    transform: translateY(-3px) !important;
    border-color: rgba(102, 126, 234, 0.6) !important;
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3) !important;
    color: white !important;
  }

  /* Icons */
  :global(.card svg) {
    color: rgba(255, 255, 255, 0.8) !important;
    transition: all 0.3s ease !important;
  }

  :global(.card:hover svg) {
    color: #78dbff !important;
  }

  /* Special components */
  :global(.intro-card), :global(.contact-card) {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.1) 100%) !important;
  }

  :global(.card .h-\[250px\]) {
    background: rgba(0, 0, 0, 0.2) !important;
    border-radius: 12px !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
  }

  :global(.security-news-card), :global(.keywords-card) {
    background: linear-gradient(135deg, rgba(120, 219, 255, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%) !important;
  }

  :global(.now-card), :global(.timezone-card) {
    background: linear-gradient(135deg, rgba(255, 119, 198, 0.1) 0%, rgba(189, 147, 249, 0.1) 100%) !important;
  }

  :global(.card span), :global(.card div), :global(.card time) {
    color: rgba(255, 255, 255, 0.9) !important;
  }

  /* Animation */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive */
  @media (max-width: 768px) {
    :global(.card p) {
      font-size: 0.95rem !important;
      line-height: 1.5 !important;
    }
    
    :global(.card h1), :global(.card h2), :global(.card h3) {
      font-size: 1.1rem !important;
    }
  }
</style>
