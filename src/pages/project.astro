---
import Layout from "../layouts/Layout.astro";
import ProjectLayout from "../layouts/ProjectLayout.astro";
import projects from "../lib/Projects";
import TerminalHeader from '../components/Terminal/TerminalHeader.astro';
import TerminalWrapper from '../components/Terminal/TerminalWrapper.astro';
import CommandLine from '../components/Terminal/CommandLine.astro';
import StyleSwitcher from '../components/StyleSwitcher.astro';
import '../style/hacker-theme.css';

const title = "Projects";

// Projects loaded successfully
---

<script>
  // Apply style on load and toggle layout visibility
  const style = localStorage.getItem('style') || 'modern';
  document.body.setAttribute('data-style', style);
  
  // Toggle layout visibility immediately to prevent flash
  const hackerContainer = document.querySelector('.hacker-container');
  const hackerLayout = document.querySelector('.hacker-layout');
  const modernLayout = document.querySelector('.modern-layout');
  
  if (style === 'hacker') {
    hackerContainer?.setAttribute('style', 'display: block !important;');
    hackerLayout?.classList.remove('hidden');
    modernLayout?.classList.add('hidden');
  } else {
    hackerContainer?.setAttribute('style', 'display: none !important;');
    hackerLayout?.classList.add('hidden');
    modernLayout?.classList.remove('hidden');
  }
</script>

<StyleSwitcher />

<ProjectLayout
  title={title}
  description="Projects"
>
  <!-- Hacker Mode Layout -->
  <div class="hacker-container">
    <TerminalWrapper class="hacker-layout hidden">
      <TerminalHeader title="root@projects:~$" />
      
      <div class="terminal-content">
        <CommandLine command="ls -la ~/projects" />
        
        <!-- File listing output -->
        <div class="file-listing">
          <div class="file-listing-line" style="color: rgba(0, 255, 65, 0.7); font-family: 'SF Mono', monospace; font-size: 0.875rem; margin-bottom: 0.5rem;">
            total {projects.length}
          </div>
          {
            projects.map((project, index) => (
              <div class="file-listing-line">
                <span style="color: rgba(0, 255, 65, 0.5);">drwxr-xr-x</span>
                <span style="color: rgba(0, 255, 65, 0.5); margin: 0 0.5rem;">2</span>
                <span style="color: rgba(0, 255, 65, 0.5); margin-right: 0.5rem;">tianchi</span>
                <span style="color: rgba(0, 255, 65, 0.5); margin-right: 1rem;">staff</span>
                <span style="color: rgba(0, 255, 65, 0.5); margin-right: 1rem;">4096</span>
                <span style="color: rgba(0, 255, 65, 0.5); margin-right: 1rem;">Nov 18 2025</span>
                <span style="color: #00ff41; font-weight: 600;">project_{String(index + 1).padStart(2, '0')}_[{project.title}]</span>
              </div>
            ))
          }
        </div>
      
        <div class="hacker-section projects-list">
          {
            projects.map((project, index) => (
              <div class="hacker-project-card">
                <div class="project-header-hacker">
                  <CommandLine command={`cat project_${String(index + 1).padStart(2, '0')}_[${project.title}]`} />
                </div>
                
                <div class="project-content-hacker">
                  <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                    <h2 style="color: #00ff41; font-family: 'SF Mono', monospace; font-size: 1.5rem; margin: 0;">{project.title}</h2>
                    <span style="color: rgba(0, 255, 65, 0.6); font-family: 'SF Mono', monospace; font-size: 0.875rem;">[0{index + 1}]</span>
                  </div>
                  
                  <div class="tech-stack-hacker">
                    {project.technologies.filter(tech => tech.trim() !== '').map((tech) => (
                      <span class="tech-tag-hacker">{tech}</span>
                    ))}
                  </div>
                  
                  <p style="color: rgba(0, 255, 65, 0.85); font-family: 'SF Mono', monospace; line-height: 1.7; margin: 1.5rem 0;">{project.description}</p>
                  
                  <a href={project.url} target="_blank" rel="noreferrer" class="project-link-hacker">
                    <span>â†’ View Project</span>
                  </a>
                </div>
              </div>
            ))
          }
        </div>
        
        <CommandLine command="echo 'End of project list'" />
      </div>
    </TerminalWrapper>
  </div>

  <!-- Modern Mode Layout -->
  <div class="projectContainer modern-layout hidden">
    <!-- Simple header for debugging -->
    <div class="header-section" style="position: relative; z-index: 10;">
      <h1 style="color: transparent; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); background-clip: text; -webkit-background-clip: text; text-align: center; font-size: clamp(2.5rem, 8vw, 4rem); margin: 0; font-weight: 800; letter-spacing: -0.02em;">My Projects</h1>
      <p style="color: rgba(255, 255, 255, 0.7); text-align: center; font-size: 1.2rem; margin-top: 1rem; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6;">Explore my portfolio of innovative projects spanning cryptography, IoT, blockchain, and data visualization.</p>
    </div>
    
    <!-- Basic grid without complex styling -->
    <div class="projects-grid-simple" style="position: relative; z-index: 10;">
      {
        projects.map((project, index) => (
          <div class="project-card-simple" style="margin-bottom: 2rem; position: relative; z-index: 10;">
            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1.5rem; gap: 1rem;">
              <h2 style="color: white; font-size: 1.5rem; margin: 0; line-height: 1.3; flex: 1; font-weight: 700;">{project.title}</h2>
              <span style="font-size: 0.875rem; font-weight: 600; color: rgba(255, 255, 255, 0.5); background: rgba(255, 255, 255, 0.1); padding: 0.5rem 1rem; border-radius: 50px; border: 1px solid rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); flex-shrink: 0;">0{index + 1}</span>
            </div>
            
            <div class="tech-simple" style="margin: 1.5rem 0; display: flex; flex-wrap: wrap; gap: 0.75rem;">
              {project.technologies.filter(tech => tech.trim() !== '').map((tech) => (
                <span style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%); color: rgba(255, 255, 255, 0.9); padding: 0.5rem 1rem; margin: 0; display: inline-block; border-radius: 50px; font-size: 0.75rem; font-weight: 600; border: 1px solid rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px); transition: all 0.3s ease;">{tech}</span>
              ))}
            </div>
            
            <p style="color: rgba(255, 255, 255, 0.8); margin: 1.5rem 0 2rem; line-height: 1.6; font-size: 1rem;">{project.description}</p>
            
            <a href={project.url} target="_blank" rel="noreferrer" class="project-link-simple">
              <span>View Project</span>
              <svg style="width: 16px; height: 16px; transition: transform 0.3s ease;" viewBox="0 0 16 16" fill="none">
                <path d="M1 8h14m0 0l-7-7m7 7l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
          </div>
        ))
      }
    </div>

    <!-- Complex version commented out for debugging
    <div class="projects-grid">
      {
        projects.map((project, index) => (
          <div class="project-card" data-index={index}>
            <div class="card-background"></div>
            <div class="card-content">
              <div class="project-header">
                <h2 class="project-title">{project.title}</h2>
                <div class="project-number">0{index + 1}</div>
              </div>
              
              <div class="tech-stack">
                {project.technologies.filter(tech => tech.trim() !== '').map((tech) => (
                  <span class="tech-tag">{tech}</span>
                ))}
              </div>
              
              <p class="project-description">{project.description}</p>
              
              <div class="card-footer">
                <a href={project.url} target="_blank" rel="noreferrer" class="project-link">
                  <span>View Project</span>
                  <svg class="link-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M1 8h14m0 0l-7-7m7 7l-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </a>
              </div>
            </div>
          </div>
        ))
      }
    </div>
    -->
  </div>
</ProjectLayout>

<style>
  /* Hacker Mode Container */
  .hacker-container {
    /* width: 100% !important; */
    /* max-width: 1200px !important; */
    /* margin: 0 auto !important; */
    /* padding: 2rem !important; */
    /* background: #000000 !important; */
    /* min-height: 100vh !important; */
    position: relative !important;
    z-index: 100 !important;
  }

  /* Override visibility for hacker content */
  .hacker-container * {
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* File listing styles */
  .file-listing {
    background: rgba(0, 20, 8, 0.3);
    border: 1px solid rgba(0, 255, 65, 0.2);
    border-radius: 8px;
    padding: 1.5rem;
    margin: 1rem 0 2rem 0;
    font-family: 'SF Mono', 'Monaco', monospace;
    font-size: 0.875rem;
  }

  .file-listing-line {
    color: rgba(0, 255, 65, 0.85);
    font-family: 'SF Mono', 'Monaco', monospace;
    line-height: 1.8;
    white-space: nowrap;
    overflow-x: auto;
    display: flex;
    align-items: center;
  }

  .file-listing-line:hover {
    background: rgba(0, 255, 65, 0.05);
    margin: 0 -0.5rem;
    padding: 0 0.5rem;
  }

  /* Hacker Mode Styles */
  .projects-list {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .hacker-project-card {
    border-left: 2px solid rgba(0, 255, 65, 0.3);
    padding-left: 1.5rem;
    margin-left: 1rem;
    position: relative;
    z-index: 101;
  }

  .project-header-hacker {
    margin-bottom: 1rem;
  }

  .project-content-hacker {
    background: rgba(0, 20, 8, 0.4);
    border: 1px solid rgba(0, 255, 65, 0.2);
    border-radius: 8px;
    padding: 1.5rem;
    transition: all 0.3s ease;
    position: relative;
    z-index: 102;
  }

  .project-content-hacker:hover {
    border-color: rgba(0, 255, 65, 0.4);
    background: rgba(0, 20, 8, 0.6);
    transform: translateX(8px);
  }

  .tech-stack-hacker {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin: 1rem 0;
  }

  .tech-tag-hacker {
    background: rgba(0, 255, 65, 0.1);
    border: 1px solid rgba(0, 255, 65, 0.3);
    color: rgba(0, 255, 65, 0.9);
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-family: 'SF Mono', monospace;
    font-size: 0.75rem;
    transition: all 0.3s ease;
  }

  .tech-tag-hacker:hover {
    background: rgba(0, 255, 65, 0.2);
    border-color: #00ff41;
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
  }

  .project-link-hacker {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    background: rgba(0, 255, 65, 0.1);
    border: 1px solid rgba(0, 255, 65, 0.4);
    color: #00ff41;
    text-decoration: none;
    border-radius: 4px;
    font-family: 'SF Mono', monospace;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .project-link-hacker:hover {
    background: rgba(0, 255, 65, 0.2);
    border-color: #00ff41;
    box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
    transform: translateX(4px);
  }

  /* Modern Mode Visibility */
  .modern-layout {
    display: block;
  }

  .modern-layout.hidden {
    display: none !important;
  }

  /* Hacker container visibility */
  .hacker-container {
    display: block;
  }

  body[data-style="hacker"] .hacker-container {
    display: block !important;
  }

  body[data-style="modern"] .hacker-container {
    display: none !important;
  }

  /* Responsive for hacker mode */
  @media (max-width: 768px) {
    .hacker-container {
      padding: 1rem;
    }

    .hacker-project-card {
      padding-left: 1rem;
      margin-left: 0.5rem;
    }

    .project-content-hacker {
      padding: 1rem;
    }
  }
</style>

<style>
  /* 
   * Z-INDEX HIERARCHY:
   * Navigation Bar: 1000 (highest - always visible)
   * Project Content: 100-110 (above modal and other page elements)
   * Modal (frontpage.css): 99 (below project content)
   * Background Effects: -1 (lowest)
   */

  /* Cool Modern Styles - Fixed visibility and spacing */
  .projectContainer {
    width: 100% !important;
    max-width: 1200px !important;
    margin: 0 auto !important;
    padding: 8rem 2rem 2rem 2rem !important; /* Extra top padding for navbar */
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%) !important;
    position: relative !important;
    z-index: 100 !important; /* Higher than modal (99) but lower than navbar (1000) */
    display: block !important;
  }

  .header-section {
    margin-bottom: 3rem !important;
    display: block !important;
    position: relative !important;
    z-index: 101 !important; /* Higher than modal and container */
    background: rgba(255, 255, 255, 0.02) !important;
    border-radius: 16px !important;
    padding: 2rem !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
  }

  /* Cool grid styling */
  .projects-grid-simple {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 2rem !important;
    position: relative !important;
    z-index: 101 !important; /* Higher than modal and container */
  }

  .project-card-simple {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    padding: 2.5rem !important;
    border-radius: 20px !important;
    display: block !important;
    position: relative !important;
    z-index: 102 !important; /* Higher than grid and modal */
    margin-bottom: 2rem !important;
    transition: all 0.3s ease !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3) !important;
  }

  .project-card-simple:hover {
    transform: translateY(-5px) !important;
    border-color: rgba(102, 126, 234, 0.4) !important;
    box-shadow: 0 20px 40px rgba(102, 126, 234, 0.2) !important;
  }

  .tech-simple {
    margin: 1rem 0 !important;
    display: block !important;
  }

  /* Cool project link styling */
  .project-link-simple {
    display: inline-flex !important;
    align-items: center !important;
    gap: 0.75rem !important;
    padding: 1rem 1.5rem !important;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    color: white !important;
    text-decoration: none !important;
    border-radius: 50px !important;
    font-weight: 600 !important;
    font-size: 0.95rem !important;
    transition: all 0.3s ease !important;
    border: 1px solid transparent !important;
    margin-top: auto !important;
  }

  .project-link-simple:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3) !important;
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%) !important;
  }

  .project-link-simple:hover svg {
    transform: translateX(4px) !important;
  }

  /* Tech tag hover effects */
  .tech-simple span:hover {
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%) !important;
    transform: translateY(-2px) !important;
  }

  /* Override any parent styles that might hide content */
  .projectContainer * {
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Add subtle animations */
  .project-card-simple {
    animation: fadeInUp 0.6s ease-out !important;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Responsive grid */
  @media (min-width: 768px) {
    .projects-grid-simple {
      grid-template-columns: repeat(2, 1fr) !important;
      gap: 2.5rem !important;
    }
    
    .project-card-simple {
      min-height: 400px !important;
    }
  }

  @media (max-width: 767px) {
    .projectContainer {
      padding: 6rem 1rem 1rem 1rem !important; /* Adjusted for mobile navbar */
    }
    
    .header-section {
      margin-bottom: 2rem !important;
      padding: 1.5rem !important;
    }
  }
</style>
